<div class="container-fluid py-4">
  <mat-card class="p-4 mb-4">
    <mat-card-header
      class="d-flex align-items-center justify-content-between mb-3"
    >
      <mat-card-title>Career Package Progress</mat-card-title>
      @if (careerPackage()) {
      <span
        class="badge ms-3"
        [ngClass]="{
          'bg-secondary text-light': careerPackage()!.status === 'NOT_STARTED',
          'bg-warning text-dark': careerPackage()!.status === 'IN_PROGRESS',
          'bg-primary text-light': careerPackage()!.status === 'COMPLETED',
          'bg-success text-light':
            careerPackage()!.status === 'SUBMITTED' ||
            careerPackage()!.status === 'APPROVED',
          'bg-danger text-light': careerPackage()!.status === 'REJECTED'
        }"
      >
        {{ careerPackage()!.status }}
      </span>
      }
    </mat-card-header>
    <mat-card-content class="mt-3">
      @if (loading()) {
      <div class="d-flex justify-content-center">
        <mat-spinner></mat-spinner>
      </div>
      } @else {
      <div class="d-flex flex-wrap align-items-center">
        <mat-progress-bar
          mode="determinate"
          [value]="careerPackage()!.progress.totalProgressPercent"
          class="flex-grow-1"
        ></mat-progress-bar>
        <span class="ms-3 mt-2 mt-md-0"
          >{{ careerPackage()!.progress.totalProgressPercent }}% Complete</span
        >
      </div>
      }
    </mat-card-content>
  </mat-card>

  <div class="row g-4 mb-4">
    @for (section of careerPackage()!.sections; track section.sectionProgressId)
    {
    <div class="col-md-6 col-lg-4">
      <app-package-section
        [sectionData]="section"
        [sectionIndex]="$index + 1"
      ></app-package-section>
    </div>
    }
  </div>

  <div class="text-center mb-4">
    <button
      (click)="submitForReview()"
      [disabled]="careerPackage()!.status !== 'COMPLETED'"
      mat-flat-button
      color="primary"
    >
      Submit for Review
    </button>
  </div>

  <mat-card>
    <mat-card-header>
      <mat-card-title>Submission History</mat-card-title>
    </mat-card-header>
    <mat-card-content class="mt-3">
      <mat-accordion>
        @for (submission of careerPackage()!.submissions; track submission.id) {
        <app-package-submission [submissionData]="submission"></app-package-submission>
        }
      </mat-accordion>
    </mat-card-content>
  </mat-card>
</div>
